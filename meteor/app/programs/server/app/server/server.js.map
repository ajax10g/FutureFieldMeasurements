{"version":3,"sources":["meteor://ðŸ’»app/server/server.js"],"names":[],"mappings":"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","file":"/server/server.js","sourcesContent":["var verifyEmail = false;\n\nAccounts.config({ sendVerificationEmail: verifyEmail });\n\nMeteor.startup(function() {\n\t// read environment variables from Meteor.settings\n\tif(Meteor.settings && Meteor.settings.env && _.isObject(Meteor.settings.env)) {\n\t\tfor(var variableName in Meteor.settings.env) {\n\t\t\tprocess.env[variableName] = Meteor.settings.env[variableName];\n\t\t}\n\t}\n\n\t//\n\t// Setup OAuth login service configuration (read from Meteor.settings)\n\t//\n\t// Your settings file should look like this:\n\t//\n\t// {\n\t//     \"oauth\": {\n\t//         \"google\": {\n\t//             \"clientId\": \"yourClientId\",\n\t//             \"secret\": \"yourSecret\"\n\t//         },\n\t//         \"github\": {\n\t//             \"clientId\": \"yourClientId\",\n\t//             \"secret\": \"yourSecret\"\n\t//         }\n\t//     }\n\t// }\n\t//\n\tif(Accounts && Accounts.loginServiceConfiguration && Meteor.settings && Meteor.settings.oauth && _.isObject(Meteor.settings.oauth)) {\n\t\t// google\n\t\tif(Meteor.settings.oauth.google && _.isObject(Meteor.settings.oauth.google)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"google\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.google;\n\t\t\tsettingsObject.service = \"google\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// github\n\t\tif(Meteor.settings.oauth.github && _.isObject(Meteor.settings.oauth.github)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"github\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.github;\n\t\t\tsettingsObject.service = \"github\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// linkedin\n\t\tif(Meteor.settings.oauth.linkedin && _.isObject(Meteor.settings.oauth.linkedin)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"linkedin\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.linkedin;\n\t\t\tsettingsObject.service = \"linkedin\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// facebook\n\t\tif(Meteor.settings.oauth.facebook && _.isObject(Meteor.settings.oauth.facebook)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"facebook\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.facebook;\n\t\t\tsettingsObject.service = \"facebook\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// twitter\n\t\tif(Meteor.settings.oauth.twitter && _.isObject(Meteor.settings.oauth.twitter)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"twitter\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.twitter;\n\t\t\tsettingsObject.service = \"twitter\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t\t// meteor\n\t\tif(Meteor.settings.oauth.meteor && _.isObject(Meteor.settings.oauth.meteor)) {\n\t\t\t// remove old configuration\n\t\t\tAccounts.loginServiceConfiguration.remove({\n\t\t\t\tservice: \"meteor-developer\"\n\t\t\t});\n\n\t\t\tvar settingsObject = Meteor.settings.oauth.meteor;\n\t\t\tsettingsObject.service = \"meteor-developer\";\n\n\t\t\t// add new configuration\n\t\t\tAccounts.loginServiceConfiguration.insert(settingsObject);\n\t\t}\n\t}\n\n\tvar url = \"mqtt://94.234.165.147\";\n    Mbus.mqttConnect(url, [\"/mbus/data\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    OneWire.mqttConnect(url, [\"/1-wire/data\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    Ethercat.mqttConnect(url, [\"/ethercat/data\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    EthercatUnits.mqttConnect(url, [\"/ethercat/units\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    Gpio.mqttConnect(url, [\"/gpio/units\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    ModbusTcp.mqttConnect(url, [\"/modbustcp/data\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    ModbusRtu.mqttConnect(url, [\"/modbusrtu/data\"], {\n        \"username\": \"marcus\",\n        \"password\": \"test\"\n    });\n    // EtherCatUnits.mqttConnect(url, [\"/modbus/units\"], {\n    //     \"username\": \"marcus\",\n    //     \"password\": \"test\"\n    // });\n\t\n});\n\nMeteor.methods({\n\t\"createUserAccount\": function(options) {\n\t\tif(!Users.isAdmin(Meteor.userId())) {\n\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t}\n\n\t\tvar userOptions = {};\n\t\tif(options.username) userOptions.username = options.username;\n\t\tif(options.email) userOptions.email = options.email;\n\t\tif(options.password) userOptions.password = options.password;\n\t\tif(options.profile) userOptions.profile = options.profile;\n\t\tif(options.profile && options.profile.email) userOptions.email = options.profile.email;\n\n\t\tAccounts.createUser(userOptions);\n\t},\n\t\"updateUserAccount\": function(userId, options) {\n\t\t// only admin or users own profile\n\t\tif(!(Users.isAdmin(Meteor.userId()) || userId == Meteor.userId())) {\n\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t}\n\n\t\t// non-admin user can change only profile\n\t\tif(!Users.isAdmin(Meteor.userId())) {\n\t\t\tvar keys = Object.keys(options);\n\t\t\tif(keys.length !== 1 || !options.profile) {\n\t\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t\t}\n\t\t}\n\n\t\tvar userOptions = {};\n\t\tif(options.username) userOptions.username = options.username;\n\t\tif(options.email) userOptions.email = options.email;\n\t\tif(options.password) userOptions.password = options.password;\n\t\tif(options.profile) userOptions.profile = options.profile;\n\n\t\tif(options.profile && options.profile.email) userOptions.email = options.profile.email;\n\t\tif(options.roles) userOptions.roles = options.roles;\n\n\t\tif(userOptions.email) {\n\t\t\tvar email = userOptions.email;\n\t\t\tdelete userOptions.email;\n\t\t\tuserOptions.emails = [{ address: email }];\n\t\t}\n\n\t\tvar password = \"\";\n\t\tif(userOptions.password) {\n\t\t\tpassword = userOptions.password;\n\t\t\tdelete userOptions.password;\n\t\t}\n\n\t\tif(userOptions) {\n\t\t\tUsers.update(userId, { $set: userOptions });\n\t\t}\n\n\t\tif(password) {\n\t\t\tAccounts.setPassword(userId, password);\n\t\t}\n\t},\t\n\t\"sendMail\": function(options) {\n\t\tthis.unblock();\n\n\t\tEmail.send(options);\n\t},\n\t\"updateSignal\": function(signalId, values) {\n\t\tif(!(Users.isAdmin(Meteor.userId()))) {\n\t\t\tthrow new Meteor.Error(403, \"Access denied.\");\n\t\t}\n\n\t\tvar signal = Signals.findOne(signalId);\n\t\tconsole.log(signal);\n\t\tif(signal){\n\t\t\tvar raw = signal.raw;\n\t\t\tvar offsetA = parseFloat(values.signal.offsetA);\n\t\t\tvar offsetB = parseFloat(values.signal.offsetB);\n\t\t\tvar scale = parseFloat(values.signal.scale);\n\t\t\tvar alarmH = parseFloat(values.signal.alarmH);\n\t\t\tvar alarmL = parseFloat(values.signal.alarmL);\n\t\t\tif(alarmH < alarmL){\n\t\t\t\tthrow new Meteor.Error(601, \"Alarm high cannot be less than alarm low.\");\n\t\t\t}\n\t\t\telse if(alarmL > alarmH){\n\t\t\t\tthrow new Meteor.Error(602, \"Alarm low cannot be greater than alarm high.\");\t\n\t\t\t}\n\t\t\telse if(alarmL == alarmH){\n\t\t\t\tthrow new Meteor.Error(603, \"Alarm low cannot be equal to alarm high.\");\t\t\n\t\t\t}\n\n\t\t\tsetObj = {\n\t\t\t\tname: values.signal.name,\n\t\t\t\toffsetA: offsetA,\n\t\t\t\toffsetB: offsetB,\n\t\t\t\tscale: scale,\n\t\t\t\tunit: values.signal.unit,\n\t\t\t\tvalue: scale*(raw+offsetA)+offsetB,\n\t\t\t\thidden: values.signal.hidden,\n\t\t\t\talarmH: alarmH,\n\t\t\t\talarmL: alarmL\n\t\t\t};\n\n\t\t\tconsole.log(setObj);\n\n\t\t\tSignals.update(signalId,{$set: setObj});\n\t\t}\n\t\telse{\n\t\t\tthrow new Meteor.Error(100, \"Signal does not exist\");\n\t\t}\n\t}\n});\n\nAccounts.onCreateUser(function (options, user) {\n\tuser.roles = [\"user\"];\n\n\tif(options.profile) {\n\t\tuser.profile = options.profile;\n\t}\n\n\t\n\treturn user;\n});\n\nAccounts.validateLoginAttempt(function(info) {\n\n\t// reject users with role \"blocked\"\n\tif(info.user && Users.isInRole(info.user._id, \"blocked\")) {\n\t\tthrow new Meteor.Error(403, \"Your account is blocked.\");\n\t}\n\n  if(verifyEmail && info.user && info.user.emails && info.user.emails.length && !info.user.emails[0].verified ) {\n\t\t\tthrow new Meteor.Error(499, \"E-mail not verified.\");\n  }\n\n\treturn true;\n});\n\n\nUsers.before.insert(function(userId, doc) {\n\tif(doc.emails && doc.emails[0] && doc.emails[0].address) {\n\t\tdoc.profile = doc.profile || {};\n\t\tdoc.profile.email = doc.emails[0].address;\n\t} else {\n\t\t// oauth\n\t\tif(doc.services) {\n\t\t\t// google e-mail\n\t\t\tif(doc.services.google && doc.services.google.email) {\n\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\tdoc.profile.email = doc.services.google.email;\n\t\t\t} else {\n\t\t\t\t// github e-mail\n\t\t\t\tif(doc.services.github && doc.services.github.accessToken) {\n\t\t\t\t\tvar github = new GitHub({\n\t\t\t\t\t\tversion: \"3.0.0\",\n\t\t\t\t\t\ttimeout: 5000\n\t\t\t\t\t});\n\n\t\t\t\t\tgithub.authenticate({\n\t\t\t\t\t\ttype: \"oauth\",\n\t\t\t\t\t\ttoken: doc.services.github.accessToken\n\t\t\t\t\t});\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar result = github.user.getEmails({});\n\t\t\t\t\t\tvar email = _.findWhere(result, { primary: true });\n\t\t\t\t\t\tif(!email && result.length && _.isString(result[0])) {\n\t\t\t\t\t\t\temail = { email: result[0] };\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(email) {\n\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\tdoc.profile.email = email.email;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// linkedin email\n\t\t\t\t\tif(doc.services.linkedin && doc.services.linkedin.emailAddress) {\n\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\tdoc.profile.name = doc.services.linkedin.firstName + \" \" + doc.services.linkedin.lastName;\n\t\t\t\t\t\tdoc.profile.email = doc.services.linkedin.emailAddress;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(doc.services.facebook && doc.services.facebook.email) {\n\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\tdoc.profile.email = doc.services.facebook.email;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(doc.services.twitter && doc.services.twitter.email) {\n\t\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\t\tdoc.profile.email = doc.services.twitter.email;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif(doc.services[\"meteor-developer\"] && doc.services[\"meteor-developer\"].emails && doc.services[\"meteor-developer\"].emails.length) {\n\t\t\t\t\t\t\t\t\tdoc.profile = doc.profile || {};\n\t\t\t\t\t\t\t\t\tdoc.profile.email = doc.services[\"meteor-developer\"].emails[0].address;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nUsers.before.update(function(userId, doc, fieldNames, modifier, options) {\n\tif(modifier.$set && modifier.$set.emails && modifier.$set.emails.length && modifier.$set.emails[0].address) {\n\t\tmodifier.$set.profile.email = modifier.$set.emails[0].address;\n\t}\n});\n\nAccounts.onLogin(function (info) {\n\t\n});\n\nAccounts.urls.resetPassword = function (token) {\n\treturn Meteor.absoluteUrl('reset_password/' + token);\n};\n\nAccounts.urls.verifyEmail = function (token) {\n\treturn Meteor.absoluteUrl('verify_email/' + token);\n};\n"]}